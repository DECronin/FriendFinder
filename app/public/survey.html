<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>FF Survey</title>
    <!-- <link rel="stylesheet" href="./style.css"> -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
</head>
<body>
    <header>Survey <a href="./home.html">Home</a></header> 
    <form>
        <div class="user">
            <h1>User Details:</h1>
            Username: 
            <input type="text" id="username"><br>
            Image Link: 
            <input type="url" id="image"><br>
        </div>
        <div class="survey">
            Slide the bar Left(Agree) and Right(Disagrre) along the 5 points as needed. [Middle is Neutral]. <br><br>
            1==============
            <input type="range" id="q1" min="1" max="5"> <br>
            2==============
            <input type="range" id="q2" min="1" max="5"> <br>
            3==============
            <input type="range" id="q3" min="1" max="5"> <br>
            4==============
            <input type="range" id="q4" min="1" max="5"> <br>
            5==============
            <input type="range" id="q5" min="1" max="5"> <br>
            6==============
            <input type="range" id="q6" min="1" max="5"> <br>
            7==============
            <input type="range" id="q7" min="1" max="5"> <br>
            8==============
            <input type="range" id="q8" min="1" max="5"> <br>
            9==============
            <input type="range" id="q9" min="1" max="5"> <br>
            10=============
            <input type="range" id="q10" min="1" max="5"> <br>
            <!-- can be created dinamically from array through loop then referanced with i? -->
        </div>
    </form>
    <button id="submit" onclick="sendData()">Submit</button>

    <!-- <div id="modal-overlay">
        <div id="modal">
                <img src="" alt="Your matches photo" id="modal-image">
                <h2>Name: <span id="modal-name"></span></h2>
        </div>
    </div> -->

    <script>

        function sendData(){
            event.preventDefault();
            let userInputs = {
                "name" : $("#username").val().trim().toString(),
                "photo" : $("#image").val().trim().toString(),
                "scores" : [
                    parseInt($("#q1").val()),
                    parseInt($("#q2").val()),
                    parseInt($("#q3").val()),
                    parseInt($("#q4").val()),
                    parseInt($("#q5").val()),
                    parseInt($("#q6").val()),
                    parseInt($("#q7").val()),
                    parseInt($("#q8").val()),
                    parseInt($("#q9").val()),
                    parseInt($("#q10").val())
                ]
            }

            console.log(`userInput-on-survey: ${JSON.stringify(userInputs)}`);

            $.post("/api/friends", userInputs, function(data){
                console.log(`survey-post-data: ${data}`);
                if(data){
                    alert(`Survey Recieved. Please wait while we calculate your results.`);
                } else {
                    alert(`Please Provide Valid Inputs.`)
                }
            })

            // $.post("/api/friends", person, data => {
            //     $("##modal-name").text(data.name);
            //     $("##modal-image").attr("src", data.image);
            //     $("##modal-overlay").show();
            // });
            // reset page to empty inputs?
        }

        function displayResult(){
            $.ajax({ url: "/api/friends", method: "GET" })
      .then(function(arrayData) {
          console.log(arrayData);

        // Loop through and display each of the customers
        for (var i = 0; i < tableData.length; i++) {

          // Get a reference to the tableList element and populate it with tables
          var tableList = $("#tableList");

          // Then display the fields in the HTML (Section Name, Date, URL)
          var listItem = $("<li class='list-group-item mt-4'>");

          listItem.append(
            $("<h2>").text("Table #" + (i + 1)),
            $("<hr>"),
            $("<h2>").text("ID: " + tableData[i].customerID),
            $("<h2>").text("Name: " + tableData[i].customerName),
            $("<h2>").text("Email: " + tableData[i].customerEmail),
            $("<h2>").text("Phone: " + tableData[i].phoneNumber)
          );

          tableList.append(listItem);
        }
      });
        }

        function compare(array) {
            let user = array[array.length - 1];
            let friends = [];
            array.forEach(e => {
                let diff = 0;
                for (i = 0; i < 10; i++) {
                    diff += Math.abs(user.scores[i] - e.scores[i]);
                }
                friends.push(diff);
            });

            for (k = 0; k < 50; k++) {
                for (j = 0; j < friends.length; j++){
                    if (friends[j] == k) {
                        return array[j]
                    }
                }
            }

            return { name: "Error", image: "https://cdn.shopify.com/s/files/1/0322/6897/files/404-permalink.png?432866230176278629", scores: [404] }

            // Display as MODAL POP UP (name and picture)
        }

    </script>
</body>
</html>